---
title: 请“保持代码洁癖”
description: 代码质量 设计模式 编程规范 代码洁癖
duration: 2 min
date: '2025-03-10 16:42:00'
---

[[toc]]

## 前言

最近在迭代公司项目的某个功能模块，需求是在原功能基础上添加新特性。当我打开页面组件时，发现代码竟然有上千行，着实令我头皮发麻。

好在代码逻辑结构清晰，只需将页面逻辑拆分成组件即可。然而，这也让我陷入思考：为什么当初写这段代码时，没意识到它会变得如此臃肿？

这其实是软件开发中常见的问题。最初的需求往往很简单，我们会优先追求快速实现，而忽略了代码结构的优化。随着需求的不断迭代，代码量不断增加，页面组件变得越来越庞大，最终难以维护。

软件开发的本质，是在不断对抗代码的腐朽。当代码开始变得臃肿，我们就需要重构——优化结构，拆分组件，提高可读性和可维护性。否则，未来的自己可能会被当下的“不作为”所折磨。

> 思考：在组件抽离的过程中，拆分视图往往是最简单的部分，而组件间的状态通信却常常让人头疼。随着业务逻辑的复杂度增加，我们该如何选择合适的组件状态通信方式，使代码既清晰又易于维护？

## “保持代码洁癖”

所谓“代码洁癖”，本质上就是对代码质量的极致追求。高质量的代码通常具备以下特性：

- **可读性**：让别人（包括未来的自己）能轻松理解你的代码。
- **可维护性**：当需求变更时，能迅速定位并修改代码。
- **可扩展性**：尽可能减少对已有代码的改动，仅通过新增代码实现新功能。
- **可复用性**：降低重复代码，提高代码复用率。

如何实现这些目标？可以从两个方面入手：

### 编程规范

代码规范是基础，它涵盖了：

- **代码风格**：如缩进、编程范式（函数式 vs. 面向对象）、代码结构等。
- **命名规范**：变量、函数、组件的命名应简洁且具备语义化。
- **模块化设计**：适当拆分文件，避免大而无当的单文件组件。

遵循好的代码规范，可以极大地提高团队协作效率，避免因代码风格不统一而导致的阅读困难。

### 设计模式

设计模式是经过实践验证的代码组织方式，能够帮助我们编写更清晰、更易维护的代码。

## 设计原则

### 单一职责原则（SRP）

> **每个组件/类应只负责一个功能**

避免“上帝组件”或“上帝类”，将不同功能拆分为独立的模块。例如，表单的验证逻辑、数据获取、UI 展示应该各自独立。

<!-- ### 组合模式（Composite Pattern）

> **像乐高积木一样构建系统**

复杂组件可以由多个简单组件组合而成，而不是写一个庞然大物。例如，一个页面通常由 `Header + Content + Footer` 组合而成，每个部分应是独立的组件。 -->

### 最小知识原则（Law of Demeter）

> **减少对象之间的耦合，不直接调用陌生对象的方法**

假设你有一个 `User` 对象，而你需要获取 `User` 的 `Profile`，正确的方式应该是 `user.getProfile()`，而不是 `user.database.getProfileById(user.id)`。后者暴露了太多实现细节，增加了代码的耦合度。

### 开放封闭原则（Open-Closed Principle）

> **对扩展开放，对修改封闭**

当需要新增功能时，尽量通过新增代码而不是修改已有代码来实现。例如，组件设计时可以利用 `slots` 或 `props` 进行扩展，而不是直接改动内部逻辑。

### KISS 原则（Keep It Simple, Stupid）

> **保持简单直白，避免不必要的复杂性**

能用 `map()` 解决的，不要写 `forEach/for + push`。

```javascript
// ❌ bad
const arr = [1, 2, 3, 4, 5]
const newArr = []
arr.forEach((num) => {
  newArr.push(num * 2)
})

// ✅ good
const newArr1 = arr.map(num => num * 2)
```

能用 CSS 解决的，不要写一大堆 JS 逻辑。<br>
能拆成两个函数的，就不要写一个超长函数。<br>

> 本文非教程文章，设计模式的学习需要一定的时间和实践，例举的设计模式原则旨在抛砖引玉，希望能给你带来一些启发。

## 结语

“保持代码洁癖”并不是死板地遵循各种规范和过于追求极致，而是要养成良好的编码习惯，让代码更加清晰、优雅、易维护。

如果你在未来的某一天，打开自己曾经写的代码，不会忍不住骂出声，那就说明你的代码质量已经上了一个台阶 👍🏻。
